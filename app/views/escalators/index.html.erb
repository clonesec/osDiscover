<% title "Escalators" %>
<div><%= add_button_link_to "new Escalator", new_escalator_path %></div>
<table cellspacing="2" cellpadding="4">
  <tr class="table_header">
    <th>Name</th>
    <th>Event</th>
    <th>Condition</th>
    <th>Method</th>
    <th colspan="3">Actions</th>
  </tr>
  <% for escalator in @escalators %>
    <tr>
      <td><%= escalator.name %></td>
      <td>
				<%= escalator.escalator_event %>
				<br />
				<%= escalator.event_data %>
			</td>
      <td>
				<%= escalator.escalator_condition %>
				<br />
			  <% escalator.condition_datas.each do |dt| %>
						 <%= dt.name %>: <%= dt.data %><br />
			  <% end %>
			</td>
      <td>
				<%= escalator.escalator_method %>
				<br />
			  <% escalator.method_datas.each do |dt| %>
						<% if (dt.name == 'notice' && dt.data == '0') || dt.name == 'submodule' || dt.name == 'from_address'
								 next
							 end
							 next if dt.data.blank?
						%>
						<%= dt.name %>: <%= dt.data %><br />
			  <% end %>
			</td>
      <td><%= pill_button_link_to "details", escalator_path(escalator.id) %></td>
      <td><%= pill_button_link_to "test escalator", test_escalator_path(escalator.id) %></td>
			<% if escalator.in_use > 0 %>
      		<td><%= disable_danger_remove_pill_button_link_to "delete", escalators_path, :title=>'escalator is in use' %></td>
			<% else %>
      		<td><%= danger_remove_pill_button_link_to "delete", escalator_path(escalator.id), :confirm => 'Are you sure?', :method => :delete %></td>
			<% end %>
    </tr>
		<tr><td colspan="8"><hr /></td></tr>
  <% end %>
</table>
